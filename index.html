<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css">
	<script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/scrollama/3.0.4/scrollama.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.3.0/d3.min.js"></script>
	
	<title>New Haven Alleys Map</title>
  </head>

  <body>

	<!-- <div style="margin-right: 2%; width:96%;">
		<img src="Guo_Yale-Bubble.jpg" style="width: 80%; margin: 3% 10%;">
		<span>image credit: Dora Guo</span>
	</div> -->
    <div>
        <h1 id="">New Haven's Alleys, Pathways, and Thoroughfares</h1>
        <video width="100%" autoplay loop style="position:sticky;z-index:1;">
            <source src="alley intro.mp4">
            
        </video>
    </div>
    <h3>Ali Hafez</h3>

  	<!-- <h2>and the Yale Places of New Haven.</h2> -->

	<!-- <hr class="center-diamond"> -->

      <section id="scrolly">
        <div class="sticky-thing">
          <!--  put something here???? -->
        </div>

        <div class="step-paragraph">
            <p style="margin-bottom: 2rem;">
                When you think about how to get around in a city, what usually comes to mind is a map of streets, 
                sidewalks, city blocks forming islands of buildings in a sea of car and pedestrian traffic, streets, and lanes.
    
            <!-- Something like this: -->
            </p>
            <img src="new_haven_road_map.png" style="width:80vw;">

            <br>
        </div>

        <div class="scrolly-overlay">
          
            
          <div class="step" id="step-zero">
            <p><span style="font-weight: bold;">You're saying <span style="color:#3363ae">Yale's campus</span> is a "bubble"?</span>
				<br><br>
               Unfortunately, that doesn't fully capture it. Yale's tendrils of influence reach 
               deep into New Haven; the two spheres are deeply intertwined, not to mention Yalies frequently 
               venture off-campus. <br><br>

               Most of their destinations, though, are close by, familiar to Yalies, 
               and are establishments that go out of their way to accomodate the Yale-affiliated.
			   This is what we'll call a <b>Yale Place</b>.
                <br> <br></p>
          </div>

          <div class="step" id="step-one">
            <p><i><b>*Yale Place:</b> A place easily-reachable from Yale's Campus, that
				 primarily caters to Yale students, and often excludes the non-Yale-affiliated -- 
				 at times with explicit exclusion, at others by being prohibitively expensive for most New Haven residents</i>.
				  <br><br>
				
				For example, <span style="color: blue; font-weight: bold;">Mory's</span> on York Street is a quintessential Yale Place. 
				Located on campus, the club/bar frequently hosts student groups, and has a membership 
				requirement only given to Yale affiliates and alumni.</p>
          </div>

		<div class="step" id="step-three" >
			<p>
				<a href="https://yaledailynews.com/blog/2022/03/01/yales-tax-exempt-property-value-surges-by-nearly-700-million/">
				Yale's property totals up to billions of dollars' worth of <b>untaxed</b>, valuable land in New Haven's downtown.</a>

				Yale-affiliated businesses out-compete local businesses. And Yale is by far New Haven's largest employer. <br>
				Yale's immense influence on New Haven is barely reciprocated on the institution, if at all.
			</p>
		</div>
		  
		  <style>
			#step-nine span,
			#step-ten span {
				text-shadow:
				-1px -1px 0 #000,
				1px -1px 0 #000,
				-1px 1px 0 #000,
				1px 1px 0 #000;
			}
		  </style>

		  <div class="step" id="step-nine"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p><b>But wait, what makes these random things Yale places?</b><br>

				There are a lot of reasons why a place can be a Yale Place. Sometimes it's history, 
				like in the case of the <span style="color: #99cc33">Grove Street Cemetery</span>, with 
				hundreds of Yale alumni over centuries buried within. <br><br>

			</p>
          </div>

		  <div class="step" id="step-ten"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p>
				At other times, like with the <span style="color: #b40fea">Wallgreens or the "Things open late"</span>, they're 
				just very convenient for Yale students.
				Similar rules apply to <span style="color: #c4901c">transit like the State St and Union Stations</span>.
				Lastly, the <span style="color: #339999">Lake Place houses</span> host several student groups and off-campus housing places. <br><br>
				These places are unimaginably important and necessary for Yalies and the Yale-affiliated, and thus end up being Yale Places
				by means of them having to be.<br><br>
			</p>
          </div>

		  <div class="step" id="step-eleven"> 
            <p><b>So this is really all of it?</b><br>
				For now! But the Yale Bubble is a dynamic, changing structure. <br> For example, as recently as six months ago, <span style="color: green">this little
				corner of Crown and High streets</span> wouldn't have been included. But recently, some luxury apartments
				went up, and a lovely, clearly college/Yale-oriented cafe called MOTW opened up.<br> The majority of customers are Yale students,
				they have late hours, and the cafe is right across from the Yale cultural centers -- that cafe is a Yale Place.</p>
          </div>

		  <div class="step" id="step-twelve"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p><b>Everything in this "bubble" is a Yale Place.</b> They appeal to Yale affiliates, out-compete New Haven 
				businesses, and disregard or even exclude local New Haven residents.<br> 
				</p>
          </div>

		  <div class="step" id="step-thirteen"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p><b>This is nearly a majority of <span style="color:#c1a600">New Haven's downtown</span>.</b> By area, about 47.5%.<br>
				Almost half of New Haven's central, dense downtown isn't <i>for</i> New Haveners -- it's for 
				the Yalies that come and go.
				</p>
          </div>

		  <div class="step" id="step-fourteen"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p>
				The bubble is a lot of New Haven's downtown, and some Yale students go their entire
				education without leaving the Yale Bubble. <b>But there's so much more to New Haven.</b> 
			</p>
          </div>

		  <div class="step" id="step-fifteen" style="margin-bottom: 100rem;"> 
			<!-- Set this class to have a longer divide between this and previous, maybe swap side of map -->
            <p>
				There are lovely places to eat and shop in <b style="color:#163b72">Westville, Wooster Square, Fair Haven, East Rock, and up Dixwell Ave.</b> <br>
				There are lovely city parks not far from campus, like <b  style="color:#163b72">Edgewood park, East Rock Park, and West Rock Park.</b><br>
				

			</p>
          </div>

        </div>
      </section>

	  <hr class="center-diamond" style="margin-top:2rem;">

	  <p id="outro-paragraph" style="margin-top:0; background-color: rgba(200, 200, 200, 0.4);">
		Some people like ______, but some people are just about the nooks and crannies.
	  </p>

	  <!-- <img src="new-haven.png" style="width: 70%; margin: 3% 15%;"> -->

    <script>
      
    /* Scrollytelling code goes under here */

	  // Code that runs when the website loads
	  document.addEventListener("DOMContentLoaded", function(e) {
      	// d3.selectAll("#yaleBuildings, #yaleBubble, #s0_A, #s1_A, #s2_A,\
		//  #s3_A, #s4_A, .g-s2_A, #s6_A, #s7_A, #s11_A, #s9_A, #s10_A, #s13_A, #s15_A").classed('hidden', true);
		// 	d3.select("#campusBubble").classed('invisible', true);
		
		//  d3.selectAll("#yaleBuildings, #yaleBubble, #s0_A, #s1_A, #s2_A,\
		//  #s3_A, #s4_A, .g-s2_A, #s6_A, #s7_A, #s11_A, #s9_A, #s10_A, #s13_A, #s15_A").style('transition', 'opacity 0.5s');
		
		//  d3.selectAll("#setTo40PercentOpac1, #setTo40PercentOpac2,\
		// 	#setTo40PercentOpac3, #setTo40PercentOpac4, #setTo40PercentOpac5").style("fill-opacity", "40%");
		
		// d3.selectAll("#opac50_1, opac50_2").style("fill-opacity", "50%");
		
		// d3.selectAll(".g-onLoad_A").classed('hidden', true);
    });

		// for debugging
		///////////////
		//
		// document.addEventListener("mousemove", (e) => {
		// 	console.log("(" + e.clientX + ", " + e.clientY + ")");
		// });

		/// STEP ZERO

		//   Entering Step Zero
		d3.select("#step-zero").on('stepin',function(e) {
			d3.select("#scrolly").style("background-color", "#bfd8d3"); // #81e8bc
			d3.selectAll("#s0_A").classed('hidden', false);
			d3.select("#yaleBuildings").classed('hidden', true);
			d3.select("#campusBubble").classed('invisible', false);
			d3.select(".ai2html-container").style("margin-left", (window.innerWidth > 700) ? "30%" : "0");
			//   d3.selectAll("#s0_A").classed('hidden', true)
			d3.select(".ai2html-container").style("transform", "scale(1.0)");
			d3.selectAll("#s1_A").classed('hidden', true); // mory's stuff
		})

		// exiting zero
		d3.select("#step-zero").on('stepout',function(e) {
			if (e.detail.direction == 'up') {
				d3.select("#campusBubble").classed('invisible', true);
				d3.select(".ai2html-container").style("margin-left", "0%");
				d3.selectAll("#s0_A").classed('hidden', true);
				d3.select("#scrolly").style("background-color", "#81b8bc");
				// d3.selectAll(".g-onLoad_A").classed('hidden', false);
			}
		})

		//   Entering Step One
		d3.select("#step-one").on('stepin',function(e) {
			// d3.selectAll("#s0_A").classed('hidden', true)
			d3.selectAll("#s1_A").classed('hidden', false); // mory's stuff
			// d3.selectAll(".g-onLoad_A").classed('hidden', true);
			d3.selectAll("#s2_A").classed('hidden', true);

			d3.select("#yaleBuildings").classed('hidden', true)
			d3.select("#campusBubble").classed('invisible', false)
			d3.select(".ai2html-container").style("transform", "scale(5.0) translate(3%, 4%)");
		})

    </script>

<script>
    const scroller = scrollama();

	scroller
		.setup({
			step: "#scrolly .scrolly-overlay .step",
			offset: 0.75,
			debug: false,
      progress: true,
      threshold: 1.0,
		})
		.onStepEnter(function({ element, index, direction}) {
			const event = new CustomEvent('stepin', { detail: { direction: direction } })
			element.dispatchEvent(event);
		})
		.onStepExit(function({ element, index, direction }) {
			const event = new CustomEvent('stepout', { detail: { direction: direction } })
			element.dispatchEvent(event);
		})
    	.onStepProgress(function({ element, index, progress}) {
      		const event = new CustomEvent('stepprogress', { detail: { progress: progress } })
			element.dispatchEvent(event);
   		});

	// const scroller2 = scrollama();

	// scroller2
	// .setup({
	// 		step: "#scrolly .scrolly-overlay .step",
	// 		offset: 0.75,
	// 		debug: false,
    //   progress: true,
    //   threshold: 1,
	// 	})
	// 	.onStepEnter(function({ element, index, direction}) {
	// 		const event = new CustomEvent('stepin', { detail: { direction: direction } })
	// 		element.dispatchEvent(event);
	// 	})
	// 	.onStepExit(function({ element, index, direction }) {
	// 		const event = new CustomEvent('stepout', { detail: { direction: direction } })
	// 		element.dispatchEvent(event);
	// 	})
    // .onStepProgress(function({ element, index, progress}) {
    //   const event = new CustomEvent('stepprogress', { detail: { progress: progress } })
	// 		element.dispatchEvent(event);
    // });

	window.addEventListener("resize", scroller.resize);
    </script>


    <!-- ai2html resizer script -->

<script type="text/javascript">
  (function() {
      // only want one resizer on the page
      if (document.documentElement.className.indexOf("g-resizer-v3-init") > -1) return;
      document.documentElement.className += " g-resizer-v3-init";
      // require IE9+
      if (!("querySelector" in document)) return;
      function resizer() {
          var elements = Array.prototype.slice.call(document.querySelectorAll(".g-artboard[data-min-width]")),
              widthById = {};
          elements.forEach(function(el) {
              var parent = el.parentNode,
                  width = widthById[parent.id] || parent.getBoundingClientRect().width,
                  minwidth = el.getAttribute("data-min-width"),
                  maxwidth = el.getAttribute("data-max-width");
              widthById[parent.id] = width;

              if (+minwidth <= width && (+maxwidth >= width || maxwidth === null)) {
                  el.style.display = "block";
              } else {
                  el.style.display = "none";
              }
          });
          try {
              if (window.parent && window.parent.$) {
                  window.parent.$("body").trigger("resizedcontent", [window]);
              }
              if (window.require) {
                  require(['foundation/main'], function() {
                      require(['shared/interactive/instances/app-communicator'], function(AppCommunicator) {
                          AppCommunicator.triggerResize();
                      });
                  });
              }
          } catch(e) { console.log(e); }
      }

      document.addEventListener('DOMContentLoaded', resizer);
      // feel free to replace throttle with _.throttle, if available
      window.addEventListener('resize', throttle(resizer, 200));        

      function throttle(func, wait) {
          // from underscore.js
          var _now = Date.now || function() { return new Date().getTime(); },
              context, args, result, timeout = null, previous = 0;
          var later = function() {
              previous = _now();
              timeout = null;
              result = func.apply(context, args);
              if (!timeout) context = args = null;
          };
          return function() {
              var now = _now(), remaining = wait - (now - previous);
              context = this;
              args = arguments;
              if (remaining <= 0 || remaining > wait) {
                  if (timeout) {
                      clearTimeout(timeout);
                      timeout = null;
                  }
                  previous = now;
                  result = func.apply(context, args);
                  if (!timeout) context = args = null;
              } else if (!timeout && options.trailing !== false) {
                  timeout = setTimeout(later, remaining);
              }
              return result;
          };
      }

     
  })();
</script>

  </body>
</html>
